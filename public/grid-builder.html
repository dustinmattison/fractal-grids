<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fractal Grid Builder - No Code Required</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .panel h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .form-section {
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .form-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }

        .form-group input[type="text"],
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 0.95rem;
            font-family: inherit;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .file-upload {
            border: 2px dashed #667eea;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .file-upload:hover {
            background: #f0f4ff;
            border-color: #5568d3;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .file-upload-label {
            display: block;
            color: #667eea;
            font-weight: 600;
        }

        .file-preview {
            margin-top: 10px;
            padding: 10px;
            background: #e8f5e9;
            border-radius: 5px;
            display: none;
        }

        .file-preview.active {
            display: block;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .preview-area {
            min-height: 400px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            overflow-y: auto;
            max-height: 600px;
        }

        .cell-preview {
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .cell-preview h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .cell-preview img {
            max-width: 100%;
            max-height: 150px;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .media-indicator {
            display: inline-block;
            padding: 5px 10px;
            background: #e3f2fd;
            border-radius: 5px;
            margin-right: 5px;
            font-size: 0.85rem;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 0 20px;
        }

        .step {
            flex: 1;
            text-align: center;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            color: white;
            font-weight: 600;
            position: relative;
        }

        .step.active {
            background: rgba(255,255,255,0.4);
        }

        .step.completed {
            background: rgba(40,167,69,0.4);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab {
            flex: 1;
            padding: 12px;
            background: #e0e0e0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .help-text {
            font-size: 0.85rem;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé® Fractal Grid Builder</h1>
            <p>Create multimedia fractal grids without writing code</p>
        </div>

        <div class="alert alert-info">
            <strong>üí° How it works:</strong> Fill out the forms below, upload your media files, and click "Generate Grid" to create a ready-to-use HTML file!
        </div>

        <div class="step-indicator">
            <div class="step active" id="step1">1. Grid Info</div>
            <div class="step" id="step2">2. Add Cells</div>
            <div class="step" id="step3">3. Preview & Export</div>
        </div>

        <div class="main-content">
            <!-- Left Panel: Form -->
            <div class="panel">
                <h2>üìù Grid Configuration</h2>

                <!-- Grid Metadata -->
                <div class="form-section">
                    <h3>Grid Information</h3>
                    <div class="form-group">
                        <label>Grid Title (English)</label>
                        <input type="text" id="gridTitleEn" placeholder="e.g., Climate Action: Global Solutions">
                    </div>
                    <div class="form-group">
                        <label>Grid Title (Chinese)</label>
                        <input type="text" id="gridTitleZh" placeholder="e.g., Ê∞îÂÄôË°åÂä®ÔºöÂÖ®ÁêÉËß£ÂÜ≥ÊñπÊ°à">
                    </div>
                    <div class="form-group">
                        <label>Grid Description</label>
                        <textarea id="gridDesc" placeholder="Brief description of your grid topic"></textarea>
                    </div>
                </div>

                <!-- Cell Editor Tabs -->
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('l0')">L0 (Core)</button>
                    <button class="tab" onclick="switchTab('l1')">L1 (9 Cells)</button>
                    <button class="tab" onclick="switchTab('l2')">L2 (Detailed)</button>
                </div>

                <!-- L0 Tab -->
                <div id="tab-l0" class="tab-content active">
                    <div class="form-section">
                        <h3>L0: Core Concept</h3>
                        <div class="form-group">
                            <label>Title (English)</label>
                            <input type="text" id="l0-titleEn" placeholder="Core concept">
                        </div>
                        <div class="form-group">
                            <label>Title (Chinese)</label>
                            <input type="text" id="l0-titleZh" placeholder="Ê†∏ÂøÉÊ¶ÇÂøµ">
                        </div>
                        <div class="form-group">
                            <label>Content (English)</label>
                            <textarea id="l0-contentEn" placeholder="Brief description"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Content (Chinese)</label>
                            <textarea id="l0-contentZh" placeholder="ÁÆÄË¶ÅÊèèËø∞"></textarea>
                        </div>
                    </div>
                </div>

                <!-- L1 Tab -->
                <div id="tab-l1" class="tab-content">
                    <div class="form-section">
                        <h3>L1: Select Cell to Edit</h3>
                        <select id="l1-cell-selector" onchange="loadL1Cell(this.value)" style="width: 100%; padding: 10px; border-radius: 5px; margin-bottom: 15px;">
                            <option value="0">Cell 1 (Top-Left)</option>
                            <option value="1">Cell 2 (Top-Center)</option>
                            <option value="2">Cell 3 (Top-Right)</option>
                            <option value="3">Cell 4 (Middle-Left)</option>
                            <option value="4">Cell 5 (Center - Sun)</option>
                            <option value="5">Cell 6 (Middle-Right)</option>
                            <option value="6">Cell 7 (Bottom-Left)</option>
                            <option value="7">Cell 8 (Bottom-Center)</option>
                            <option value="8">Cell 9 (Bottom-Right)</option>
                        </select>

                        <div class="form-group">
                            <label>Title (English)</label>
                            <input type="text" id="l1-titleEn" placeholder="Cell title">
                        </div>
                        <div class="form-group">
                            <label>Title (Chinese)</label>
                            <input type="text" id="l1-titleZh" placeholder="ÂçïÂÖÉÊ†ºÊ†áÈ¢ò">
                        </div>
                        <div class="form-group">
                            <label>Content (English)</label>
                            <textarea id="l1-contentEn" placeholder="Brief description"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Content (Chinese)</label>
                            <textarea id="l1-contentZh" placeholder="ÁÆÄË¶ÅÊèèËø∞"></textarea>
                        </div>

                        <!-- Media Upload -->
                        <div class="form-group">
                            <label>üì∑ Upload Image (Optional)</label>
                            <div class="file-upload" onclick="document.getElementById('l1-image').click()">
                                <input type="file" id="l1-image" accept="image/*" onchange="handleImageUpload(this, 'l1')">
                                <span class="file-upload-label">Click to upload image</span>
                            </div>
                            <div id="l1-image-preview" class="file-preview"></div>
                        </div>

                        <div class="form-group">
                            <label>üéß Upload Audio/Podcast (Optional)</label>
                            <div class="file-upload" onclick="document.getElementById('l1-audio').click()">
                                <input type="file" id="l1-audio" accept="audio/*" onchange="handleAudioUpload(this, 'l1')">
                                <span class="file-upload-label">Click to upload audio</span>
                            </div>
                            <div id="l1-audio-preview" class="file-preview"></div>
                        </div>

                        <div class="form-group">
                            <label>üé¨ Upload Video (Optional)</label>
                            <div class="file-upload" onclick="document.getElementById('l1-video').click()">
                                <input type="file" id="l1-video" accept="video/*" onchange="handleVideoUpload(this, 'l1')">
                                <span class="file-upload-label">Click to upload video</span>
                            </div>
                            <div id="l1-video-preview" class="file-preview"></div>
                        </div>

                        <button class="btn btn-primary" onclick="saveL1Cell()">üíæ Save Cell</button>
                    </div>
                </div>

                <!-- L2 Tab -->
                <div id="tab-l2" class="tab-content">
                    <div class="alert alert-info">
                        <strong>Coming soon!</strong> L2 detailed cells will be added in the next version. For now, focus on L0 and L1.
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-success" onclick="generateGrid()">üöÄ Generate Grid HTML</button>
                    <button class="btn btn-secondary" onclick="resetForm()">üîÑ Reset All</button>
                </div>
            </div>

            <!-- Right Panel: Preview -->
            <div class="panel">
                <h2>üëÅÔ∏è Live Preview</h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress" style="width: 0%">0% Complete</div>
                </div>
                <div class="preview-area" id="preview">
                    <p style="text-align: center; color: #999; padding: 40px;">
                        Start filling out the form to see your grid preview here
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        const gridData = {
            metadata: {
                titleEn: '',
                titleZh: '',
                description: ''
            },
            L0: {},
            L1: Array(9).fill(null).map(() => ({})),
            L2: [],
            media: {
                images: {},
                audio: {},
                video: {}
            }
        };

        let currentL1Cell = 0;

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`tab-${tab}`).classList.add('active');
        }

        // L1 Cell management
        function loadL1Cell(index) {
            currentL1Cell = parseInt(index);
            const cell = gridData.L1[currentL1Cell];
            
            document.getElementById('l1-titleEn').value = cell.titleEn || '';
            document.getElementById('l1-titleZh').value = cell.titleZh || '';
            document.getElementById('l1-contentEn').value = cell.contentEn || '';
            document.getElementById('l1-contentZh').value = cell.contentZh || '';
            
            updatePreview();
        }

        function saveL1Cell() {
            const cell = gridData.L1[currentL1Cell];
            cell.titleEn = document.getElementById('l1-titleEn').value;
            cell.titleZh = document.getElementById('l1-titleZh').value;
            cell.contentEn = document.getElementById('l1-contentEn').value;
            cell.contentZh = document.getElementById('l1-contentZh').value;
            
            alert('‚úÖ Cell saved! Select another cell to edit or generate your grid.');
            updateProgress();
            updatePreview();
        }

        // File upload handlers
        function handleImageUpload(input, level) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const key = `${level}-${currentL1Cell || 0}-image`;
                    gridData.media.images[key] = {
                        data: e.target.result,
                        filename: file.name
                    };
                    
                    const preview = document.getElementById(`${level}-image-preview`);
                    preview.innerHTML = `‚úÖ Image uploaded: ${file.name}`;
                    preview.classList.add('active');
                };
                reader.readAsDataURL(file);
            }
        }

        function handleAudioUpload(input, level) {
            const file = input.files[0];
            if (file) {
                const key = `${level}-${currentL1Cell || 0}-audio`;
                gridData.media.audio[key] = {
                    filename: file.name,
                    size: (file.size / 1024 / 1024).toFixed(1) + ' MB'
                };
                
                const preview = document.getElementById(`${level}-audio-preview`);
                preview.innerHTML = `‚úÖ Audio uploaded: ${file.name} (${gridData.media.audio[key].size})`;
                preview.classList.add('active');
            }
        }

        function handleVideoUpload(input, level) {
            const file = input.files[0];
            if (file) {
                const key = `${level}-${currentL1Cell || 0}-video`;
                gridData.media.video[key] = {
                    filename: file.name,
                    size: (file.size / 1024 / 1024).toFixed(1) + ' MB'
                };
                
                const preview = document.getElementById(`${level}-video-preview`);
                preview.innerHTML = `‚úÖ Video uploaded: ${file.name} (${gridData.media.video[key].size})`;
                preview.classList.add('active');
            }
        }

        // Progress tracking
        function updateProgress() {
            let completed = 0;
            let total = 11; // L0 + 9 L1 cells + metadata
            
            if (gridData.metadata.titleEn) completed++;
            if (gridData.L0.titleEn) completed++;
            
            gridData.L1.forEach(cell => {
                if (cell.titleEn) completed++;
            });
            
            const percentage = Math.round((completed / total) * 100);
            const progressBar = document.getElementById('progress');
            progressBar.style.width = percentage + '%';
            progressBar.textContent = percentage + '% Complete';
        }

        // Preview generation
        function updatePreview() {
            const preview = document.getElementById('preview');
            let html = '';
            
            // Show L0 if filled
            if (gridData.L0.titleEn) {
                html += `
                    <div class="cell-preview">
                        <h4>L0: Core Concept</h4>
                        <p><strong>${gridData.L0.titleEn}</strong> / ${gridData.L0.titleZh || '...'}</p>
                        <p>${gridData.L0.contentEn || '...'}</p>
                    </div>
                `;
            }
            
            // Show L1 cells
            gridData.L1.forEach((cell, index) => {
                if (cell.titleEn) {
                    const imageKey = `l1-${index}-image`;
                    const audioKey = `l1-${index}-audio`;
                    const videoKey = `l1-${index}-video`;
                    
                    html += `
                        <div class="cell-preview">
                            <h4>L1 Cell ${index + 1}: ${cell.titleEn}</h4>
                            ${gridData.media.images[imageKey] ? `<img src="${gridData.media.images[imageKey].data}" alt="${cell.titleEn}">` : ''}
                            <p>${cell.contentEn || '...'}</p>
                            ${gridData.media.audio[audioKey] ? `<span class="media-indicator">üéß Audio</span>` : ''}
                            ${gridData.media.video[videoKey] ? `<span class="media-indicator">üé¨ Video</span>` : ''}
                        </div>
                    `;
                }
            });
            
            if (html === '') {
                html = '<p style="text-align: center; color: #999; padding: 40px;">Start filling out the form to see your grid preview here</p>';
            }
            
            preview.innerHTML = html;
        }

        // Generate final HTML
        function generateGrid() {
            if (!gridData.metadata.titleEn || !gridData.L0.titleEn) {
                alert('‚ö†Ô∏è Please fill out at least the Grid Title and L0 Core Concept before generating.');
                return;
            }
            
            // For now, show success message and instructions
            alert('üéâ Grid generation complete!\n\nYour grid data has been prepared. In the next step, this will download a ready-to-use HTML file.\n\nFor now, you can manually copy your content into the multimedia-template.html file.');
            
            console.log('Grid Data:', gridData);
        }

        function resetForm() {
            if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
                location.reload();
            }
        }

        // Auto-save metadata
        document.getElementById('gridTitleEn').addEventListener('input', (e) => {
            gridData.metadata.titleEn = e.target.value;
            updateProgress();
        });

        document.getElementById('gridTitleZh').addEventListener('input', (e) => {
            gridData.metadata.titleZh = e.target.value;
            updateProgress();
        });

        document.getElementById('gridDesc').addEventListener('input', (e) => {
            gridData.metadata.description = e.target.value;
        });

        // Auto-save L0
        ['titleEn', 'titleZh', 'contentEn', 'contentZh'].forEach(field => {
            document.getElementById(`l0-${field}`).addEventListener('input', (e) => {
                gridData.L0[field] = e.target.value;
                updateProgress();
                updatePreview();
            });
        });
    </script>
</body>
</html>
